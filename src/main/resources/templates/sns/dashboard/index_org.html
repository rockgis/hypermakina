<!DOCTYPE html>
<!--
This is a starter template page. Use this page to start your new project from
scratch. This page gets rid of all links and provides the needed markup only.
-->
<html lang="en" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>HyperMSLK 서비스</title>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="/webjars/AdminLTE/plugins/fontawesome-free/css/all.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="/webjars/AdminLTE/dist/css/adminlte.min.css">


    <link rel="stylesheet" href="/js/billboard/css/datalab.min.css">
    <link rel="stylesheet" href="/js/billboard/css/insight.min.css">


</head>
<body class="hold-transition layout-top-nav dark-mode">
<div class="wrapper">
    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <div class="content-header">
        </div>
        <!-- /.content-header -->


        <!-- Main content -->
        <div class="content">
            <div class="container">

                <div class="row">
                    <div class="col-lg-3 col-6">
                        <!-- small box -->
                        <div class="small-box bg-info">
                            <div class="inner">
                                <h3>MES System</h3>
                                <p>Server: </p>
                                <p>WAS: </p>
                                <p>DB: </p>
                            </div>
                            <div class="icon">
                                <i class="ion ion-bag"></i>
                            </div>
                        </div>
                    </div>
                    <!-- ./col -->
                    <div class="col-lg-3 col-6">
                        <!-- small box -->
                        <div id="cpuChart" ></div>

                    </div>
                    <!-- ./col -->
                    <div class="col-lg-3 col-6">
                        <!-- small box -->
                        <div id="memChart" ></div>
                    </div>
                    <!-- ./col -->
                    <div class="col-lg-3 col-6">
                        <!-- small box -->
                        <div class="small-box bg-success">
                            <div class="inner">
                                <h3 id="clock" >15:00:00</h3>

                                <p id="day" >2022년 3월 24일 </p>
                            </div>
                            <div class="icon">
                                <i class="ion ion-pie-graph"></i>
                            </div>
                        </div>
                    </div>
                    <!-- ./col -->
                </div>
                <!-- /.row -->


                <div class="row">
                    <div class="col-md-6">
                        <!-- AREA CHART -->
                        <div class="card card-primary">
                            <div class="card-header">
                                <h3 class="card-title">CPU Usage</h3>
                            </div>
                            <div class="card-body">
                                <div class="chart">
                                    <canvas id="cpulineChart" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                                </div>
                            </div>
                            <!-- /.card-body -->
                        </div>
                        <!-- /.card -->

                        <!-- DONUT CHART -->
                        <div class="card card-danger">
                            <div class="card-header">
                                <h3 class="card-title">Disk Usage</h3>
                            </div>
                            <div class="card-body">
                                <div class="chart">
                                    <canvas id="diskChart" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                                </div>
                            </div>
                            <!-- /.card-body -->
                        </div>
                        <!-- /.card -->

                    </div>
                    <!-- /.col (LEFT) -->
                    <div class="col-md-6">
                        <!-- LINE CHART -->
                        <div class="card card-info">
                            <div class="card-header">
                                <h3 class="card-title">Ram Usage</h3>
                            </div>
                            <div class="card-body">
                                <div class="chart">
                                    <canvas id="ramChart" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                                </div>
                            </div>
                            <!-- /.card-body -->
                        </div>
                        <!-- /.card -->

                        <!-- BAR CHART -->
                        <div class="card card-success">
                            <div class="card-header">
                                <h3 class="card-title">Netwok Usage</h3>
                            </div>
                            <div class="card-body">
                                <div class="chart">
                                    <canvas id="networkChart" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                                </div>
                            </div>
                            <!-- /.card-body -->
                        </div>
                        <!-- /.card -->


                    </div>
                    <!-- /.col (RIGHT) -->
                </div>


                </div><!-- /.container-fluid -->
            </div>
            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->


    </div>
    <!-- ./wrapper -->
</div>
<!-- jQuery -->
<script src="/webjars/AdminLTE/plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap 4 -->
<script src="/webjars/AdminLTE/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- Ekko Lightbox -->
<script src="/webjars/AdminLTE/plugins/ekko-lightbox/ekko-lightbox.min.js"></script>
<!-- AdminLTE App -->
<script src="/webjars/AdminLTE/dist/js/adminlte.min.js"></script>
<!-- Filterizr-->
<script src="/webjars/AdminLTE/plugins/filterizr/jquery.filterizr.min.js"></script>

<script type="text/javascript" src="/js/crossdomain/jquery.ajax-cross-origin.min.js"></script>

<script src="/js/billboard/js/billboard.pkgd.min.js"></script>

<script type="text/javascript" src="/js/chart/hyperChart.js"></script>

<!-- ChartJS -->
<script src="/webjars/AdminLTE/plugins/chart.js/Chart.js"></script>
<script src="/js/chart/ConfigCreator.js"></script>

<script th:inline="javascript">

    let datasets = new Array();
    let datasets2 = new Array();
    let datasets3 = new Array();
    let datasets4 = new Array();
    let lineX = [];

    let cpu_data  = [];
    let ram_data  = [];
    let disk_data  = [];
    let newtwork_data  = [];

    /*[# th:each="article : ${systemSummarylist}"]*/
    console.log(/*[[${article.msmt_time}]]*/);
    lineX.push(/*[[${article.msmt_time}]]*/);
    cpu_data.push(/*[[${article.cpu_util}]]*/)
    ram_data.push(/*[[${article.free_mem_avail}]]*/)
    disk_data.push(/*[[${article.swap_avail}]]*/)
    newtwork_data.push(/*[[${article.free_mem_avail}]]*/)
    /*[/]*/

    datasets.push(new DataElement("MES_App_1_t ",cpu_data));
    //datasets.push(new DataElement("Server 2 ",ram_data));
    //datasets.push(new DataElement("Server 3 ",disk_data));
    //datasets.push(new DataElement("Server 4 ",newtwork_data));

    //datasets2.push(new DataElement("MES_App_1_t ",cpu_data));
    datasets2.push(new DataElement("MES_App_1_t",ram_data));
    //datasets2.push(new DataElement("Server 3 ",disk_data));
    //datasets2.push(new DataElement("Server 4 ",newtwork_data));


    //datasets3.push(new DataElement("MES_App_1_t ",cpu_data));
    //datasets3.push(new DataElement("Server 2 ",ram_data));
    datasets3.push(new DataElement("MES_App_1_t ",disk_data));
    //datasets3.push(new DataElement("Server 4 ",newtwork_data));

    //datasets4.push(new DataElement("MES_App_1_t ",cpu_data));
    //datasets4.push(new DataElement("Server 2 ",ram_data));
    //datasets4.push(new DataElement("Server 3 ",disk_data));
    datasets4.push(new DataElement("MES_App_1_t ",newtwork_data));


</script>



<script>

    var initMinute;  // 최초 설정할 시간(min)
    var remainSecond;  // 남은시간(sec)

    $(document).ready(function() {

        getClock();

        var cpu_data = [
            ["CPU Used", 10.4]
        ];

        var ram_data = [
            ["Ram Used", 50.2]
        ];

        var swap_data = [
            ["SWAP Used", 40.3]
        ];

        chart_gauge("#cpuChart",cpu_data);
        chart_gauge("#memChart",ram_data);

        lineCart(lineX,datasets,datasets2,datasets3,datasets4);

        setTimeout(function () {
            location.reload();
            //alert("페이지 리로드 하기 ");
        }, 300000);
    });

    //System Details - Summary
/*
    ["TRGT_HOST  PORT_NO  SITE_NAME  INFO  MSMT_HOST  MSMT_TIME  CPU_UTIL  CPU_UTIL_ST  SYS_CPU_UTIL  SYS_CPU_UTIL_ST  RUNNING_PROC  RUNNING_PROC_ST  BLOCKED_PROC  BLOCKED_PROC_ST  SWAP_AVAIL  SWAP_AVAIL_ST  FREE_MEM_AVAIL  FREE_MEM_AVAIL_ST  MEM_SCAN_RATE  MEM_SCAN_RATE_ST  STEAL_TIME  STEAL_TIME_ST  ",
        "MES_App_1_t NULL NULL +Summary MES_App_1_t 2023-03-07 15:02:36  0.4977 GOOD 0.2330 GOOD 0.0000 GOOD 0.0000 GOOD 11769.8203 GOOD 6130.1719 GOOD 0.0000 GOOD -5.0000 GOOD",
        "MES_App_1_t NULL NULL +Summary MES_App_1_t 2023-03-07 15:07:24  0.8100 GOOD 0.3411 GOOD 0.0000 GOOD 0.0000 GOOD 11776.5273 GOOD 6126.7031 GOOD 0.0000 GOOD -5.0000 GOOD",
        "MES_App_1_t NULL NULL +Summary MES_App_1_t 2023-03-07 15:12:17  1.4796 GOOD 0.4663 GOOD 0.0000 GOOD 0.0000 GOOD 11786.4336 GOOD 6114.5156 GOOD 0.0000 GOOD -5.0000 GOOD",
        "MES_App_1_t NULL NULL +Summary MES_App_1_t 2023-03-07 15:17:00  1.1916 GOOD 0.7836 GOOD 0.0000 GOOD 0.0000 GOOD 11795.0117 GOOD 6076.7461 GOOD 0.0000 GOOD -5.0000 GOOD",
        "MES_App_1_t NULL NULL +Summary MES_App_1_t 2023-03-07 15:21:43  1.2806 GOOD 0.6947 GOOD 0.0000 GOOD 0.0000 GOOD 11793.7852 GOOD 6078.5586 GOOD 0.0000 GOOD -5.0000 GOOD",
        "MES_App_1_t NULL NULL +Summary MES_App_1_t 2023-03-07 15:26:29  0.3286 GOOD 0.2310 GOOD 0.0000 GOOD 0.0000 GOOD 11794.0977 GOOD 6077.6523 GOOD 0.0000 GOOD -5.0000 GOOD",
        "MES_App_1_t NULL NULL +Summary MES_App_1_t 2023-03-07 15:31:11  0.2723 GOOD 0.2397 GOOD 0.0000 GOOD 0.0000 GOOD 11797.2656 GOOD 6066.1406 GOOD 0.0000 GOOD -5.0000 GOOD",
        "MES_App_1_t NULL NULL +Summary MES_App_1_t 2023-03-07 15:35:59  0.3796 GOOD 0.3796 GOOD 0.0000 GOOD 0.0000 GOOD 11798.1641 GOOD 6068.4375 GOOD 0.0000 GOOD -5.0000 GOOD",
        "MES_App_1_t NULL NULL +Summary MES_App_1_t 2023-03-07 15:40:47  0.8626 GOOD 0.7324 GOOD 0.0000 GOOD 0.0000 GOOD 11793.8398 GOOD 6060.0273 GOOD 0.0000 GOOD -5.0000 GOOD",
        "MES_App_1_t NULL NULL +Summary MES_App_1_t 2023-03-07 15:45:46  0.8378 GOOD 0.4423 GOOD 0.0000 GOOD 0.0000 GOOD 11795.6406 GOOD 6062.9023 GOOD 0.0000 GOOD -5.0000 GOOD",
        "MES_App_1_t NULL NULL +Summary MES_App_1_t 2023-03-07 15:50:36  0.9331 GOOD 0.7379 GOOD 0.0000 GOOD 0.0000 GOOD 11808.5273 GOOD 6056.8320 GOOD 0.0000 GOOD -5.0000 GOOD",
        "MES_App_1_t NULL NULL +Summary MES_App_1_t 2023-03-07 15:55:42  0.9747 GOOD 0.4541 GOOD 0.0000 GOOD 0.0000 GOOD 11811.3125 GOOD 6051.3555 GOOD 0.0000 GOOD -5.0000 GOOD"
    ]*/

/* Ram
        "TRGT_HOST  PORT_NO  SITE_NAME  INFO  MSMT_HOST  MSMT_TIME  TOTAL_PHY_MEM  TOTAL_PHY_MEM_ST  USED_PHY_MEM  USED_PHY_MEM_ST  FREE_PHY_MEM  FREE_PHY_MEM_ST  PHYSICAL_MEM_UTILZE  PHYSICAL_MEM_UTILZE_ST  PHYSICAL_AVAIL_MEM  PHYSICAL_AVAIL_MEM_ST  MODIFIED_MEM  MODIFIED_MEM_ST  STANDBY_MEM  STANDBY_MEM_ST  CACHED_MEM  CACHED_MEM_ST  MAX_MEM_ALLOCATE  MAX_MEM_ALLOCATE_ST  MAX_MEM_USAGE  MAX_MEM_USAGE_ST  AUTOMATION_STATUS  AUTOMATION_STATUS_ST  ",
        "MES_App_1_t NULL NULL - MES_App_1_t 2023-03-07 15:02:41  15838.0000 GOOD 9694.5430 GOOD 246.7227 GOOD 61.2107 GOOD 6130.0000 GOOD 13.4570 GOOD 5883.2773 GOOD 5896.7344 GOOD -5.0000 GOOD -5.0000 GOOD 5.0000 GOOD",
        "MES_App_1_t NULL NULL - MES_App_1_t 2023-03-07 15:08:05  15838.0000 GOOD 9701.9297 GOOD 239.5078 GOOD 61.2573 GOOD 6125.0000 GOOD 11.0703 GOOD 5885.4922 GOOD 5896.5625 GOOD -5.0000 GOOD -5.0000 GOOD 5.0000 GOOD",
        "MES_App_1_t NULL NULL - MES_App_1_t 2023-03-07 15:13:26  15838.0000 GOOD 9716.9570 GOOD 228.5273 GOOD 61.3522 GOOD 6109.0000 GOOD 12.0430 GOOD 5880.4727 GOOD 5892.5156 GOOD -5.0000 GOOD -5.0000 GOOD 5.0000 GOOD",
        "MES_App_1_t NULL NULL - MES_App_1_t 2023-03-07 15:18:40  15838.0000 GOOD 9746.0078 GOOD 192.1055 GOOD 61.5356 GOOD 6080.0000 GOOD 11.9922 GOOD 5887.8945 GOOD 5899.8867 GOOD -5.0000 GOOD -5.0000 GOOD 5.0000 GOOD",
        "MES_App_1_t NULL NULL - MES_App_1_t 2023-03-07 15:23:16  15838.0000 GOOD 9749.9102 GOOD 193.4414 GOOD 61.5602 GOOD 6076.0000 GOOD 12.0898 GOOD 5882.5586 GOOD 5894.6484 GOOD -5.0000 GOOD -5.0000 GOOD 5.0000 GOOD",
        "MES_App_1_t NULL NULL - MES_App_1_t 2023-03-07 15:28:28  15838.0000 GOOD 9750.2930 GOOD 197.2266 GOOD 61.5627 GOOD 6076.0000 GOOD 11.7070 GOOD 5878.7734 GOOD 5890.4805 GOOD -5.0000 GOOD -5.0000 GOOD 5.0000 GOOD",
        "MES_App_1_t NULL NULL - MES_App_1_t 2023-03-07 15:33:49  15838.0000 GOOD 9754.9531 GOOD 186.0312 GOOD 61.5921 GOOD 6070.0000 GOOD 13.0469 GOOD 5883.9687 GOOD 5897.0156 GOOD -5.0000 GOOD -5.0000 GOOD 5.0000 GOOD",
        "MES_App_1_t NULL NULL - MES_App_1_t 2023-03-07 15:39:02  15838.0000 GOOD 9758.4219 GOOD 180.9805 GOOD 61.6140 GOOD 6066.0000 GOOD 13.5781 GOOD 5885.0195 GOOD 5898.5977 GOOD -5.0000 GOOD -5.0000 GOOD 5.0000 GOOD",
        "MES_App_1_t NULL NULL - MES_App_1_t 2023-03-07 15:43:48  15838.0000 GOOD 9755.5977 GOOD 187.4258 GOOD 61.5961 GOOD 6069.0000 GOOD 13.4023 GOOD 5881.5742 GOOD 5894.9766 GOOD -5.0000 GOOD -5.0000 GOOD 5.0000 GOOD",
        "MES_App_1_t NULL NULL - MES_App_1_t 2023-03-07 15:49:07  15838.0000 GOOD 9767.4258 GOOD 176.7617 GOOD 61.6708 GOOD 6058.0000 GOOD 12.5742 GOOD 5881.2383 GOOD 5893.8125 GOOD -5.0000 GOOD -5.0000 GOOD 5.0000 GOOD",
        "MES_App_1_t NULL NULL - MES_App_1_t 2023-03-07 15:53:43  15838.0000 GOOD 9765.8281 GOOD 166.3320 GOOD 61.6607 GOOD 6058.0000 GOOD 14.1719 GOOD 5891.6680 GOOD 5905.8398 GOOD -5.0000 GOOD -5.0000 GOOD 5.0000 GOOD",
        "MES_App_1_t NULL NULL - MES_App_1_t 2023-03-07 15:59:08  15838.0000 GOOD 9761.9336 GOOD 171.9219 GOOD 61.6362 GOOD 6076.0000 GOOD 0.0664 GOOD 5904.0781 GOOD 5904.1445 GOOD -5.0000 GOOD -5.0000 GOOD 5.0000 GOOD"
*/



    function lineCart(lineX) {

        var ss_day = new Date();
        var minu = 5;


        //lineX.push(ss_day.getHours() + ":" + ss_day.getMinutes());
        //lineX.push(ss_day.getHours() + ":" + ss_day.getMinutes()+5);
        //lineX.push(ss_day.getHours() + ":" + ss_day.getMinutes()+10);
        //lineX.push(ss_day.getHours() + ":" + ss_day.getMinutes()+15);
        //lineX.push(ss_day.getHours() + ":" + ss_day.getMinutes()+20);
        //lineX.push(ss_day.getHours() + ":" + ss_day.getMinutes()+25);
        //lineX.push(ss_day.getHours() + ":" + ss_day.getMinutes()+30);






        var i = 0;


        var randomColor = function() {
            var r = Math.floor(Math.random() * 255);
            var g = Math.floor(Math.random() * 255);
            var b = Math.floor(Math.random() * 255);
            return "rgba(" + r + "," + g + "," + b + ","+0.7+")";
        }

        var configMaker = new ConfigMaker();

        var config = configMaker.createLineChartConfig(lineX,datasets,false,"Server");
        var lineChartCanvas          = document.getElementById('cpulineChart').getContext('2d');
        var lineChart                = new Chart(lineChartCanvas,config);

        var config2 = configMaker.createLineChartConfig(lineX,datasets2,false,"Server");
        var lineChartCanvas2          = document.getElementById('ramChart').getContext('2d');
        var lineChart2                = new Chart(lineChartCanvas2,config2);

        var config3 = configMaker.createLineChartConfig(lineX,datasets3,false,"Server");
        var lineChartCanvas3          = document.getElementById('diskChart').getContext('2d');
        var lineChart3                = new Chart(lineChartCanvas3,config3);

        var config4 = configMaker.createLineChartConfig(lineX,datasets3,false,"Server");
        var lineChartCanvas4          = document.getElementById('networkChart').getContext('2d');
        var lineChart4                = new Chart(lineChartCanvas4,config4);

    }



    function getClock(){
        const date = new Date()
        const year = date.getFullYear();
        const month = date.getMonth();
        const day = date.getDate();
        day.innerText = `${year}년 ${month} 월 ${day}일`;

        const hour = String(date.getHours()).padStart(2,"0");
        const minutes = String(date.getMinutes()).padStart(2,"0");
        const second = String(date.getSeconds()).padStart(2,"0");//number이기 때문에 padStart 붙일 수 없음. String 변환해주어야한다.
        clock.innerText = `${hour}:${minutes}:${second}`;
    }




    function ajax_rest(){


        let person = {name:"abc", age:10};
        let person2 = {};

        let managerurl = "http://172.30.1.109:7077";
        let user = "admin";
        let pwd ="bHlpanVuIUAwOQ==";


        $.ajax({
            crossOrigin : true,
            type:'POST', //요청 메서드
            url: 'http://172.30.1.109:7077/api/eg/analytics/getAlarmCount', //요청 URI
            contentType : 'application/json',
            headers : { 'managerurl':managerurl,
                'user':user,
                'pwd':pwd,
                'Accept':'application/json'
            }, //요청 헤더
            dataType : 'json', //전송할 데이터 타입
            //data : JSON.stringify(person), //서버로 전송할 데이터. 직렬화.
            success : function(result) {

                alert(JSON.parse(result));
            },
            error : function(request, status, error) {
                //alert("error: " + error)
            } //에러가 발생했을 때 호출될 함수
        }); //$.ajax()


    }


</script>

</body>
</html>
